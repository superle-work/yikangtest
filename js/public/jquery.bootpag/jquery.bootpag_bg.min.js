(function(h, q) {
	h.fn.bootpag = function(p) {
        if(p.total == 0){p.total = 1;}
		function m(c, b) {
			b = parseInt(b, 10);
			var d, e = 0 == a.maxVisible ? 1 : a.maxVisible,
				k = 1 == a.maxVisible ? 0 : 1,
				n = Math.floor((b - 1) / e) * e,
				f = c.find("li");
			a.page = b = 0 > b ? 0 : b > a.total ? a.total : b;
			f.removeClass(a.activeClass);
			d = 1 > b - 1 ? 1 : a.leaps && b - 1 >= a.maxVisible ? Math.floor((b - 1) / e) * e : b - 1;
			a.firstLastUse && f.first().toggleClass(a.disabledClass, 1 === b);
			e = f.first();
			a.firstLastUse && (e = e.next());
			e.toggleClass(a.disabledClass, 1 === b).attr("data-lp", d).find("a").attr("href", g(d));
			k = 1 == a.maxVisible ? 0 : 1;
			d = b + 1 > a.total ? a.total : a.leaps && b + 1 < a.total - a.maxVisible ? n + a.maxVisible + k : b + 1;
			e = f.last();
			a.firstLastUse && (e = e.prev());
			e.toggleClass(a.disabledClass, b === a.total).attr("data-lp", d).find("a").attr("href", g(d));
			f.last().toggleClass(a.disabledClass, b === a.total);
			e = f.filter("[data-lp=" + b + "]");
			k = "." + [a.nextClass, a.prevClass, a.firstClass, a.lastClass].join(",.");
			if (!e.not(k).length) {
				var m = b <= n ? -a.maxVisible : 0;
				f.not(k).each(function(b) {
					d = b + 1 + n + m;
					h(this).attr("data-lp", d).toggle(d <= a.total).find("a").html(d).attr("href", g(d))
				});
				e = f.filter("[data-lp=" + b + "]")
			}
			e.not(k).addClass(a.activeClass);
			l.data("settings", a)
		}
		function g(c) {
			return a.href.replace(a.hrefVariable, c)
		}
		var l = this,
			a = h.extend({
				total: 0,
				page: 1,
				maxVisible: null,
				leaps: !0,
				href: "javascript:void(0);",
				hrefVariable: "{{number}}",
				next: "&raquo;",
				prev: "&laquo;",
				firstLastUse: !1,
				first: '<span aria-hidden="true">&larr;</span>',
				last: '<span aria-hidden="true">&rarr;</span>',
				wrapClass: "pagination",
				activeClass: "active",
				disabledClass: "disabled",
				nextClass: "next",
				prevClass: "prev",
				lastClass: "last",
				firstClass: "first"
			}, l.data("settings") || {}, p || {});
		if (0 >= a.total) return this;
		h.isNumeric(a.maxVisible) || a.maxVisible || (a.maxVisible = parseInt(a.total, 10));
		l.data("settings", a);
		return this.each(function() {
			var c, b, d = h(this);
			c = ['<ul class="', a.wrapClass, ' bootpag">'];
			a.firstLastUse && (c = c.concat(['<li data-lp="1" class="', a.firstClass, '"><a href="', g(1), '">', a.first, "</a></li>"]));
			a.prev && (c = c.concat(['<li data-lp="1" class="', a.prevClass, '"><a href="', g(1), '">', a.prev, "</a></li>"]));
			for (b = 1; b <= Math.min(a.total, a.maxVisible); b++) c = c.concat(['<li data-lp="', b, '"><a href="', g(b), '">', b, "</a></li>"]);
			a.next && (b = a.leaps && a.total > a.maxVisible ? Math.min(a.maxVisible + 1, a.total) : 2, c = c.concat(['<li data-lp="', b, '" class="', a.nextClass, '"><a href="', g(b), '">', a.next, "</a></li>"]));
			a.firstLastUse && (c = c.concat(['<li data-lp="', a.total, '" class="last"><a href="', g(a.total), '">', a.last, "</a></li>"]));
			c.push("</ul>");
			d.find("ul.bootpag").remove();
			d.append(c.join(""));
			c = d.find("ul.bootpag");
			d.find("li").click(function() {
				var b = h(this);
				if (!b.hasClass(a.disabledClass) && !b.hasClass(a.activeClass)) {
					var c = parseInt(b.attr("data-lp"), 10);
					l.find("ul.bootpag").each(function() {
						m(h(this), c)
					});
					l.trigger("page", c)
				}
			});
			m(c, a.page);

            //添加分页文字描述信息
            var html = "<div class='text-desc-area'>";
            html +="共"+p.total+"页";
            if(p.total_count != undefined){
                html+="/"+p.total_count+"条记录</div>";
            }
            if($(this).find(".text-desc-area").length > 0){//若已存在描述信息，直接移除
                $(this).find(".text-desc-area").remove();
            }
            var curPageSize =  $(this).find("#paging-mode").val() || p.pageSize;//获取当前设置的每页显示记录数值
            if($(this).find("#paging-mode").length == 0){//若不存在分页模式，加入
                if(curPageSize == 10){//记录上次分页模式：每页10条、20条、30条、50条、100条
                	html = html+ "<select id='paging-mode'><option value='10' selected>每页显示10条</option><option value='20'>每页显示20条</option><option value='30'>每页显示30条</option><option value='50'>每页显示50条</option><option value='100'>每页显示100条</option></select>";
                }else if(curPageSize == 20){
                	html = html+ "<select id='paging-mode'><option value='10'>每页显示10条</option><option value='20' selected>每页显示20条</option><option value='30'>每页显示30条</option><option value='50'>每页显示50条</option><option value='100'>每页显示100条</option></select>";
                }else if(curPageSize == 30){
                	html = html+ "<select id='paging-mode'><option value='10'>每页显示10条</option><option value='20'>每页显示20条</option><option value='30' selected>每页显示30条</option><option value='50'>每页显示50条</option><option value='100'>每页显示100条</option></select>";
                }else if(curPageSize == 50){
                	html = html+ "<select id='paging-mode'><option value='10'>每页显示10条</option><option value='20'>每页显示20条</option><option value='30'>每页显示30条</option><option value='50' selected>每页显示50条</option><option value='100'>每页显示100条</option></select>";
                }else if(curPageSize == 100){
                	html = html+ "<select id='paging-mode'><option value='10'>每页显示10条</option><option value='20'>每页显示20条</option><option value='30'>每页显示30条</option><option value='50'>每页显示50条</option><option value='100' selected>每页显示100条</option></select>";
                }
            }
            
            $(this).append(html);//重新添加描述信息
		});
	}
})(jQuery, window);